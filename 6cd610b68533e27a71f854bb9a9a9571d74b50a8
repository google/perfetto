Cherry-picked as f35ae1939989c58c29df43f9c2d8610f5b932715 (#1349)
